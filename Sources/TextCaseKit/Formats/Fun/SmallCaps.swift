import Foundation

public final class SmallCaps: Format {
    public var name: String = "Small Caps"
    public var description: String = "Convert all characters into small capital characters."
    public var id: String = "smallCaps"

    public init() {}

    let capsMap: [String: String] = [
        "a": "ᴀ",
        "b": "ʙ",
        "c": "ᴄ",
        "d": "ᴅ",
        "e": "ᴇ",
        "f": "ғ",
        "g": "ɢ",
        "h": "ʜ",
        "i": "ɪ",
        "j": "ᴊ",
        "k": "ᴋ",
        "l": "ʟ",
        "m": "ᴍ",
        "n": "ɴ",
        "o": "ᴏ",
        "p": "ᴘ",
        "q": "ǫ",
        "r": "ʀ",
        "s": "s",
        "t": "ᴛ",
        "u": "ᴜ",
        "v": "ᴠ",
        "w": "ᴡ",
        "x": "x",
        "y": "ʏ",
        "z": "ᴢ",
        "µ": "µ",
        "ß": "ß",
        "à": "ᴀ̀",
        "á": "ᴀ́",
        "â": "ᴀ̂",
        "ã": "ᴀ̃",
        "ä": "ᴀ̈",
        "å": "ᴀ̊",
        "æ": "æ",
        "ç": "ᴄ̧",
        "è": "ᴇ̀",
        "é": "ᴇ́",
        "ê": "ᴇ̂",
        "ë": "ᴇ̈",
        "ì": "ɪ̀",
        "í": "ɪ́",
        "î": "ɪ̂",
        "ï": "ɪ̈",
        "ð": "ð",
        "ñ": "ɴ̃",
        "ò": "ᴏ̀",
        "ó": "ᴏ́",
        "ô": "ᴏ̂",
        "õ": "ᴏ̃",
        "ö": "ᴏ̈",
        "ø": "ø",
        "ù": "ᴜ̀",
        "ú": "ᴜ́",
        "û": "ᴜ̂",
        "ü": "ᴜ̈",
        "ý": "ʏ́",
        "þ": "þ",
        "ÿ": "ʏ̈",
        "ā": "ᴀ̄",
        "ă": "ᴀ̆",
        "ą": "ᴀ̨",
        "ć": "ᴄ́",
        "ĉ": "ᴄ̂",
        "ċ": "ᴄ̇",
        "č": "ᴄ̌",
        "ď": "ᴅ̌",
        "đ": "đ",
        "ē": "ᴇ̄",
        "ĕ": "ᴇ̆",
        "ė": "ᴇ̇",
        "ę": "ᴇ̨",
        "ě": "ᴇ̌",
        "ĝ": "ɢ̂",
        "ğ": "ɢ̆",
        "ġ": "ɢ̇",
        "ģ": "ɢ̧",
        "ĥ": "ʜ̂",
        "ħ": "ħ",
        "ĩ": "ɪ̃",
        "ī": "ɪ̄",
        "ĭ": "ɪ̆",
        "į": "ɪ̨",
        "ı": "ı",
        "ĳ": "ĳ",
        "ĵ": "ᴊ̂",
        "ķ": "ᴋ̧",
        "ĸ": "ĸ",
        "ĺ": "ʟ́",
        "ļ": "ʟ̧",
        "ľ": "ʟ̌",
        "ŀ": "ŀ",
        "ł": "ł",
        "ń": "ɴ́",
        "ņ": "ɴ̧",
        "ň": "ɴ̌",
        "ŉ": "ŉ",
        "ŋ": "ŋ",
        "ō": "ᴏ̄",
        "ŏ": "ᴏ̆",
        "ő": "ᴏ̋",
        "œ": "œ",
        "ŕ": "ʀ́",
        "ŗ": "ʀ̧",
        "ř": "ʀ̌",
        "ś": "ś",
        "ŝ": "ŝ",
        "ş": "ş",
        "š": "š",
        "ţ": "ᴛ̧",
        "ť": "ᴛ̌",
        "ŧ": "ŧ",
        "ũ": "ᴜ̃",
        "ū": "ᴜ̄",
        "ŭ": "ᴜ̆",
        "ů": "ᴜ̊",
        "ű": "ᴜ̋",
        "ų": "ᴜ̨",
        "ŵ": "ᴡ̂",
        "ŷ": "ʏ̂",
        "ź": "ᴢ́",
        "ż": "ᴢ̇",
        "ž": "ᴢ̌",
    ]

    let uppercase =
        "ABCDEFGHIJKLMNOPQRSTUVWXYZΜSSÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝÞŸĀĂĄĆĈĊČĎĐĒĔĖĘĚĜĞĠĢĤĦĨĪĬĮIĲĴĶĸĹĻĽĿŁŃŅŇʼNŊŌŎŐŒŔŖŘŚŜŞŠŢŤŦŨŪŬŮŰŲŴŶŹŻŽ"

    public func process(_ input: String) -> String {
        guard !input.isEmpty else { return "" }
        var converted = ""
        for char in input {
            if !uppercase.contains(char), let caps = capsMap[char.lowercased()] {
                converted.append(caps)
            } else {
                converted.append(char)
            }
        }
        return converted
    }
}
